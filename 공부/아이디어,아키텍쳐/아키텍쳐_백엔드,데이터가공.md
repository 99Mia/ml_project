### Backend / Data Processing
데이터가 들어와 서 KPI 로 변환되기 전까지 처리되는 단계이다

# Data Ingestion API
역할: 외부/설비 데이터 수집
- 센서 데이터, PLC 로그, MES/ERP 데이터, 품질 검사 데이터 등을 받아오는 엔드포인트
- 실시간 스트리밍(E/S), 배치 업로드, 혹은 Rest API/WebSocket 방식 등으로 구현 가능

현업에서 하는일:
- 데이터 소스별 형식 정의(Json, CSV, MQTT 등)
- Spring Boot 에서 Controller/Endpoint 작성 -> 데이터 수신
- 수신된 데이터 임시 저장 또는 메시지 큐(Kafka, RabbitMQ)로 전달



# Data Validation (데이터 검증)
역할: 들어온 데이터가 제대로 되었는지 확인
- 누락값, 비정상 값, 센서 오류 값 필터링
- 시계열 순서, 단위, 타입 검사
예. 
온도 센서값이 -100도면 비정상 -> 제거/대체
필수 컬럼 누락 시 로그 기록 및 알람

현업에서 하는일:
- Spring Boot Service에서 데이터 검사 로직 구현
- 이상 데이터 로깅 및 알람 연동


# Feature Engineering (특정 추출)
역할 : ML 모델과 KPI 계산에 필요한 입력값 생성
- 단순 센서값 -> 모델 입력 값으로 변환
- 예: 1초 단위 진동 ->  1분 평균, 최대값, 표준편차 계산
- 시계열 지표, 이동 평균, 차분, 누적합 등

현업에서 하는 일:
- python ML 모델 기준 Feature 정의
- Spring Boot 나 배치 작업에서 Feature 계산 후 DB 저장
- Feature 이름, 타입, 스케일 관리

# KPI Aggregation (KPI 집계)
역할: Feature -> KPI 로 변환 ,요약 정보 생성
- 설비별 이상 점수 합산
- 불량률, 예상 손실 비용 계산
- 시간 단위/설비 단위 집계
예. 최근 1시간 평균 이상 점수
예.  설비 A 예상 불량률 = a * 이상치 + b * 품질데이터 + ...

현업에서 하는 일:
- KPI 계산 로직 서비스 구현(Spring Boot Service Layer)
- 주기적 스케줄링: 매 1분, 5분, 1시간 단위 집계

# MySQl (DB 저장)
역할: 처리된 데이터, Feature, KPI 저장
- 실시간 수집 데이터
- 계산된 Feature/KPI
- 모델 학습용 데이터

현업에서 하는 일:
- 테이블 구조 설계: 센서, 로그, 품질, KPI 테이블
- 인덱스 최적화 : 실시간 조회 성능 확보
- Spring Data JPA 사용 : 코드에서 편하게 CRUD


### 정리
1. Data Ingestion : 모든 데이터 소스 연결 및 수집
2. Validation : 결측치, 오류, 타입 체크
3. Feature Engineering: ML/KPI 입력값으로 변환 (x값)
4. KPI Aggregation : 집계 + 요약 KPI 계산
5. DB 저장 : Mysql에 저장 후 Dashboard 연동 준비
Spring Boot 가 데이터 처리 파이프라인 핵심 엔진이 된다


### 확장설계 - Quality

1. Defect Flag 계산 
- 센서값 (tool_wear, torque, delta_temp) + 공정 조건(product_type, 공정 단계, tool 교체 여부 등)
- 단순 임계값이 아니라 EWMA, rolling std 등 시계열 통계를 이용
- 목표: 서서히 발생하는 열화/마모 까지 감지
- python / 데이터 엔지니어링 코드에서 수행

2. Spec 값 생성
- 실제 측정 오차 수준의 랜덤 노이즈 반영
- product_type 이나 공정 단계 기준으로 분류
- kpi 계산 및 품질 시뮬레이션에서 활용

3. Residual, Anomaly Score 계산
- RPM -> Torque 기준선 계산 -> residual
- residual -> anomaly score 변환
- AI 모델 또는 통계 기반 계산
- 데이터 가공 단계에서 미리 계산 후 DB에 저장

4. EWMA, rolling 통계
- 단기/중기/장기 열화 감지
- risk_level 결정 기준

