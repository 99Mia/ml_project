### Data Source
- Sensor Data
- PLC / Machine Log
- Production DB
- Quality Inspection Data

# - Sensor Data (Real-Time)
먼저 Sensor Data 는 설비에 직접 붙어 있는 물리 센서 데이터이다
예: 온도 센서, 진동 센서, 전류/전압, 압력, 속도, RPM
특징: 
- 초 단위/ ms 단위로 들어오는 시계열 데이터 (시간의 흐름에 따라 순서대로 기록된 데이터)
- 예지보전 AI 의 핵심 입력값
--> 설비 상태를 실시간으로 반영하는 물리 센서 데이터입니다.

(형태는 숫자이고, 연속적인 값, 주기적으로 들어옴. 예 : 68.2, 68.3)


# - PLC / Machine Log (Near Real-Time)
그 다음 PLC / Machine Log
의미: 설비 제어기 (PLC) 또는 장비에서 발생하는 운영 로그 데이터 
(
  로그 데이터: 시스템이나 설비에서 "무슨 일이 발생했는지"를 기록한 이벤트 이력
  --> 사건 발생 시
  )
예시:
- 설비 on/off
- 에러 코드 (E101, E202 등)  
--> 에러/알람로그 : 설비가 스스로 남기는 기록(과전류, 과열, 센서이상, 통신오류...)
- 모드 변경 (Auto/Manual)
- 작업 시작, 종료 신호
- 제어 명령 로그
--> PLC 가 수행한 명령 기록 (밸브 열림, 모터 속도 변경, 축 이동... 등 설비가 어떻게 움직였는지)
특징
- 센서보다 이벤트 중심
- 고장 원인 분석에 매우 중요
--> 설비 동작 이력과 이벤트 정보를 담은 로그 데이터입니다. 

AI 활용: 최근 1시간 내 재시작 횟수, 에러 코드 발생 빈도, 수동 모드 전환 여부
AI 에서는 로그를 Feature로 변환해서 사용한다
error_count_last_10min = 3
manual_mode_ratio = 0.4
restart_count = 2
...


************
면접 : 운영 로그 데이터는 설비의 상태 변화와 이벤트를 기록한 데이터로, 센서 데이터만으로는 구분하기 어려운 사람 개입이나 에러 원인을 보완하는 역할을 합니다.






# - Production DB (MES/ERP Data)
-> 생산 공정에서 발생하는 "업무 이력 데이터"를 저장한 데이터 베이스이다
- 센서/로그 가 "기계 관점" 이라면 Production DB는 업무, 공정 관점이다

Production DB의 의미는 MES / ERP 등에서 관리하는 생산 정보 데이터이다
- MES (Manufacturing Execution System) :
  현장에서 실제로 무엇을 ,언제 ,어떻게 만들었는지 관리하는 시스템
예:
- 공정 번호
- 작업 시작/ 종료 시간
- 설비 ID
- 작업자 ID
- 생산 수량
- LOT / Batch 번호
- 공정별 상태
ex.
설비 A 
공정 3
10:00 ~ 10:30
500개 생산
--> 현장 밀착형 시스템

- ERP (Enterprise Resouce Planning)
역할: 회사의 전체 자원(자재, 인력, 비용, 일정)을 관리하는 시스템
- 생산 계획
- 작업 지시서
- 자재 소요
- 원가
- 납기
- 고객 주문
ex.
주문 1000개
납기: 1/20
자재 투입량 ...
--> 경영,관리 중심 시스템

특징 : 
- 주로 정형 데이터
- 센서 데이터와 조합하면 "왜 고장 났는지" 설명 가능
--> 생산 공정과 작업 이력을 관리하는 정형 데이터입니다.

예지보전에서 Production DB 가 중요한 이유
1. 같은 센서 값인데 결과가 다를 수 있다
고속 공정 -> 정상
저속 공정 -> 이상
공정 정보가 없으면 AI 판단 오류

2. 작업 조건이 고장에 영향
어떤 제품, 어떤 공정, 어떤 작업자? 
-> 고장은 맥락(Context)가 문제이다

3. 품질, 생산성과 연결 가능
고장 -> (설비 정지, 생산 중단) -> 생산량 감소
    KPI 변화: 생산량 하락, 가동률 하락, 납기 지연 가능성 높음 -> 이건 AI랑 직접 연결 가능
    예. AI 가 "2시간 낸 고장 가능성 80%"
        시스템이 "오늘 예상 생산량 -120개"
    AI 결과가 경경 KPI 로 변환됨

이상 -> 불량률 증가
  이상 상태에서 무슨일이 생기냐면 
  -미세한 진동 증가
  -온도 편차
  -공정 조건 불안정
  제품은 만들어지지만 품질이 흔들림
  KPI 변화 : 불량률 높음, 재작업 높음, 품질 비용 높아짐

KPI 확장 가능하다 (Key Performance Indicator)
- 현장이 잘 돌아가고 있는지 판단하는 핵심 지표
- (생산량, 불량률, 설비 가동률, MTBF/MTTR, OEE)

### Production DB (KPI 확장 - 의사결정)
*** 중요한거는 예지보전 시스템의 진짜 가치는 정확도만 높이는게 아니라 현장 판단을 돕는 것이다
AI 예측
-> KPI 영향도 계산
-> 운영 판단
ex.
# 이상치(anomaly score = 0.87)
이건 AI 입장에서 "정상 패턴에서 얼마나 벗어났는지" 를 나타낸거다
이상치 점수(anomaly score)은 AI 가 만든다
-Isolation Forest -> 0.87
-LOF -> 0.82
-통계기반 -> 0.75
이거를 정규화/가중 평균 해서
Fianl Anomaly Score = 0.84 이다. 

KPI 는 AI + Rule 결합 구조이다

사람이 임계치를 만들어놔야 한다. (현장 기준값은 엔지니어/운영팀 합의)
0.8 보다 높으면 High (설비 이상 위험 높음)
0.6 이상이면 Medium
나머지는 Low
--> 이거는 AI 가 아니라 Rule-based KPI Logic 이다
1. Anamaly Score(이상치) 
2. Rule/ Regression
-> 규칙 정하고 회귀
우리가 가진 것(x): 이상치, 진동, 온도, 전류 값, 설비 사용 시잔
우리가 알고 싶은 것(y): 불량률은 몇 %, 고장은 언제? 손실 비용은 얼마?
x -> y 로 숫자를 예측하는 회귀가 필요
KPI 는 거의 다 회귀 문제이다.
회귀가 없으면 알람만 울린다. 회귀가 있으면 불량률을 예측하고 손실 비용을 계산하고
정비 우선순위를 자동화 할 수 있다

회귀: 불량률 +3.2%
Input(x):
-Anamaly Score
-최근 1시간 평균 진동
-가동시간
Regression Model ->
output:
-Expected Defect Rate(%) 

3. Expected Defect Rate


**** 머신러닝 모델이 AI ?
머신러닝은 AI의 한 분야이다
하지만 모든 AI가 머신러닝은 아니다
AI 에는 
- 규칙기반 시스템(Rule-based)
- 머신러닝
- 딥러닝
- 전문가 시스템
- 최적화 알고리즘

머신러닝(Machine Learning) 이란?
데이터를 통해 규칙을 스스로 학습하는 AI
- Isolation Forest
- Linear Regression
- Random Forest
- SVM



이상치 숫자만 보여주면 현장/관리자가 이해하지 못한다
KPI로 번역하면 (계산해서 대시보드에 넣어야함)
- 설비 A 이상 위험 높음
- 예상 불량률 + 3.2%
- 예상 손실 비용 1,500만원  (이거는 AI 가 아니라 경영 KPI)
--> 의사결정 가능 
# --> 1차 판단 지금 멈출 건가? 
현장이 제일 먼저 보는 것은 
- 고장 시점 예측
- 잔여 운전 가능 시간(RUL)
케이스 A
RUL: 30분 -> 즉시 정지 (손실보다 고장 리스크가 큼)
케이스 B
RUL: 6시간 -> 다음 단계 판단
# --> 2차 판단 : 운전 조건을 바꿀 수 있나?
선택지 예시:
- 생산 속도 저하
- 부하 저하
- 공정 조건 완화
- 제품 등급 변경
-> 완전 정지 말고 리스크 낮추기
# --> 3차 판단 : 언제 정비할까?
지금 정지 : 고장 임박, 안전 위험
야간 정비 : 생산 영향 최소
다음 계획정비 : 리스크 낮음
AI는 추천하고, 결정은 사람이 한다

# 품질 쪽 의사결정
이상 + 불량률 상승 예상이면
- 해당 시간대 제품
- 전수 검사
- 샘플링 강화
- 등급 낮춰 출하
- 재작업 계획 수립
--> 품질팀 개입
# 관리자의 판단(비용기준)
지금 멈추면 손실: 500만원
고장 나면 손실: 3000만원
--> 멈춤 선택
또는
지금 멈추면 손실: 2000만원
고장 리스크 낮음
--> 유지 선택
# 대시보드 
단순 숫자 x , 행동 가이드 o
[설비 A]
위험도: High
권장 조치: 
- 속도 20% 감소
- 4시간 내 점검 권장
- 야간 정비 후보


즉, AI는 고장/이상을 예측
KPI 는 비즈니스 영향 
KPI  확장 = AI 결과를 현장 언어로 바꾸는 것

AI 활용:
조건 정보(Feature)로 사용
- process_id
- product_type
- shift_type
- planned_vs_actual_ratio



*********
면접: MES 와 ERP에서 수집한 생산 공정 및 작업 이력 데이터를 센서, 로그 데이터와 결합해,
설비 상태를 공정 맥락까지 고려한 예지보전 모델을 구성했습니다,
예지보전 결과를 설비 상태 지표에 그치지 않고, 생산량과 품질 KPI 로 연결해 현장과 관리자가
즉시 의사결정할 수 있도록 설계했습니다
!!!! AI 는 결정을 대신하지 않는다. AI는 판단 근거를 제공한다
예지보전 결과는 고장 가능성과 KPI 영향도를 함께 제공하고, 현장은 이를 기준으로 운전 조건 조정,
정비 시점 결정, 품질 대응 등 단계적 의사결정을 수행합ㄴ디ㅏ
요약:
-AI -> 위험도 + 영향도
-현장 -> 상황별 대응 선택
-시스템 -> 결정 지원도구





# - Quality Inspection Data
의미: 검사 공정에서 발생하는 품질 결과 데이터
예시:
- 합격/ 불합격 (제품이 기준 통과 여부)
- 불량 유형 (깨짐, 흠집, 치수 오차 등)
- 치수 오차 (설계치와 실제 측정치 차이)
- 검사 장비 측정값 (센서 기반 측정 수치)

특징 : 
- 예지보전 + 품질 예측 연결 가능
(품질 데이터는 설비 상태의 간접 지표가 될 수 있다)
(예. 불량률이 갑자기 증가하면 설비 상태에 문제가 있을 가능성이 높다)

- 고장 -> 품질 불량 상관관계 분석 가능
(설비 고장/이상 신호와 불량 유형/불량율을 연결)
(머신러닝/회귀 모델로 불량률 예측 가능)
--> 제품 품질 결과를 기반으로 설비 상태를 간접적으로 판단하는 데이터입니다
즉, 품질 데이터나 센서 이상치만 보고 설비가 문제일 수 있다고 에측하는 것이다


상황. 공정에서 나온 제품 불량률이 갑자기 5%
추정. 
- 원인 후보: 설비 B 부품 마모
- 결론 : 설비 B 상태 점검 필요
--> 데이터가 경고를 준 것 뿐, 실제 고장은 확인 후 판정 

KPI 및 의사결정 활용
- 품질 데이터 기반 KPI 생성 (불량률, 불량 유형별 비율)
- 이상 점수와 연결
--> 불량률 5% 이상 -> 설비 점검 필요







###  왜 DataSource 를 이렇게 4개로 나누었는지
--> Sensor Data 는 실시간 상태
--> PLC Log 는 행동/이벤트
--> Production DB는 업무 맥락
--> Quality Data 는 결과 지표

이렇게 4개가 합쳐져야 예측 가능한 AI가 된다